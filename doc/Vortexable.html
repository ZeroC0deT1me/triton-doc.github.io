<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>@Vortexable — Triton Framework</title>
<link href="https://fonts.googleapis.com/css2?family=DM+Mono:ital,wght@0,300;0,400;0,500;1,400&family=Syne:wght@400;600;700;800&display=swap" rel="stylesheet">
<style>
  :root{--bg:#0b0d12;--surface:#111420;--surface2:#181c2b;--border:#232840;--accent:#4f8ef7;--accent2:#a78bfa;--warn:#f59e0b;--danger:#ef4444;--success:#22c55e;--text:#d4d8f0;--muted:#6b7280;--code-bg:#0d1117;--vortex:#f97316}
  *,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
  html{scroll-behavior:smooth}
  body{font-family:'Syne',sans-serif;background:var(--bg);color:var(--text);line-height:1.7;min-height:100vh}
  body::before{content:'';position:fixed;inset:0;background-image:url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.03'/%3E%3C/svg%3E");pointer-events:none;z-index:0}
  .layout{display:grid;grid-template-columns:280px 1fr;min-height:100vh;position:relative;z-index:1}
  aside{position:sticky;top:0;height:100vh;overflow-y:auto;background:var(--surface);border-right:1px solid var(--border);padding:0 0 2rem;display:flex;flex-direction:column}
  .back-bar{display:flex;align-items:center;gap:.6rem;padding:1.1rem 1.5rem;border-bottom:1px solid var(--border);text-decoration:none;color:var(--muted);font-family:'DM Mono',monospace;font-size:.78rem;transition:color .15s,background .15s;flex-shrink:0}
  .back-bar:hover{color:var(--text);background:var(--surface2)}
  .sidebar-header{padding:1.6rem 1.5rem .5rem;flex-shrink:0}
  .sidebar-pkg{font-family:'DM Mono',monospace;font-size:.7rem;color:var(--muted);margin-bottom:.4rem}
  .sidebar-classname{font-size:1.1rem;font-weight:800;color:#fff;line-height:1.2}
  .sidebar-kind{display:inline-block;margin-top:.5rem;font-family:'DM Mono',monospace;font-size:.67rem;font-weight:600;letter-spacing:.1em;text-transform:uppercase;border-radius:4px;padding:.15em .55em;color:#fcd34d;background:rgba(251,191,36,.1);border:1px solid rgba(251,191,36,.25)}
  nav{padding:1rem 1rem 0;flex:1}
  nav .nav-section{font-size:.65rem;font-weight:700;letter-spacing:.18em;text-transform:uppercase;color:var(--muted);padding:1rem .75rem .4rem;display:block}
  nav a{display:flex;align-items:center;gap:.5rem;padding:.4rem .75rem;border-radius:6px;color:#8b92b8;text-decoration:none;font-size:.84rem;font-family:'DM Mono',monospace;transition:all .15s;border-left:2px solid transparent}
  nav a:hover{color:var(--text);background:var(--surface2);border-left-color:var(--vortex)}
  nav a.inner{font-size:.78rem;padding-left:1.5rem;color:#5a6080}
  nav a.inner::before{content:'↳';font-size:.7rem;color:var(--border)}
  nav a.inner:hover{color:#8b92b8;border-left-color:var(--accent2)}
  main{padding:3.5rem 4rem 5rem;max-width:960px}
  .hero{margin-bottom:3.5rem;padding-bottom:2.5rem;border-bottom:1px solid var(--border)}
  .hero-badge{display:inline-flex;align-items:center;gap:.5rem;font-size:.7rem;font-weight:600;letter-spacing:.15em;text-transform:uppercase;color:var(--vortex);background:rgba(249,115,22,.08);border:1px solid rgba(249,115,22,.25);border-radius:100px;padding:.32rem .9rem;margin-bottom:1.3rem;font-family:'DM Mono',monospace}
  .hero-badge::before{content:'';width:5px;height:5px;border-radius:50%;background:var(--vortex);animation:pulse 2s infinite}
  @keyframes pulse{0%,100%{opacity:1}50%{opacity:.3}}
  h1{font-size:2.5rem;font-weight:800;color:#fff;line-height:1.1;margin-bottom:.75rem;letter-spacing:-.01em}
  .hero-meta{display:flex;align-items:center;gap:1.5rem;flex-wrap:wrap;font-family:'DM Mono',monospace;font-size:.8rem;color:var(--muted);margin-bottom:1rem}
  .hero-meta code{background:rgba(255,255,255,.06);border:1px solid var(--border);border-radius:4px;padding:.1em .45em;color:#a5b4fc;font-size:.82em}
  .hero-desc{font-size:.975rem;color:var(--muted);font-family:'DM Mono',monospace;font-weight:300;line-height:1.85;max-width:680px}
  .class-divider{display:flex;align-items:center;gap:1rem;margin:4rem 0 2rem;padding-top:3rem;border-top:1px solid var(--border)}
  .class-divider h2{font-size:1.5rem;font-weight:800;color:#fff;margin:0}
  .class-divider h2::after{display:none}
  .badge-enum{background:rgba(167,139,250,.12);color:var(--accent2);border:1px solid rgba(167,139,250,.25)}
  .class-divider-badge{display:inline-flex;align-items:center;font-family:'DM Mono',monospace;font-size:.67rem;font-weight:600;letter-spacing:.1em;text-transform:uppercase;padding:.25em .7em;border-radius:4px;white-space:nowrap;flex-shrink:0}
  section{margin-bottom:3.5rem}
  h2{font-size:1.5rem;font-weight:700;color:#fff;margin-bottom:.5rem;display:flex;align-items:center;gap:.75rem}
  h2::after{content:'';flex:1;height:1px;background:var(--border)}
  p{color:var(--text);margin-bottom:1rem;font-size:.94rem;font-family:'DM Mono',monospace;font-weight:300;line-height:1.85}
  pre{background:var(--code-bg);border:1px solid var(--border);border-radius:10px;padding:1.5rem;overflow-x:auto;margin:1.25rem 0;position:relative}
  pre::before{content:attr(data-lang);position:absolute;top:.75rem;right:1rem;font-size:.63rem;font-weight:600;letter-spacing:.1em;text-transform:uppercase;color:var(--muted);font-family:'DM Mono',monospace}
  code{font-family:'DM Mono',monospace;font-size:.855rem;line-height:1.7}
  pre code{color:#e2e8f0}
  :not(pre)>code{background:rgba(255,255,255,.07);border:1px solid var(--border);border-radius:4px;padding:.1em .4em;font-size:.82em;color:#a5b4fc}
  .kw{color:#c084fc}.ty{color:#67e8f9}.str{color:#86efac}.cm{color:#4b5563;font-style:italic}.an{color:#fbbf24}
  .callout{border-radius:10px;padding:1.15rem 1.4rem;margin:1.4rem 0;border-left:3px solid;font-family:'DM Mono',monospace;font-size:.875rem;font-weight:300;line-height:1.75}
  .callout strong{font-weight:600;display:block;margin-bottom:.3rem;text-transform:uppercase;font-size:.68rem;letter-spacing:.12em}
  .callout-info{background:rgba(79,142,247,.08);border-color:var(--accent);color:#93b8fb}
  .callout-warn{background:rgba(245,158,11,.08);border-color:var(--warn);color:#fcd34d}
  .callout-danger{background:rgba(239,68,68,.08);border-color:var(--danger);color:#fca5a5}
  .callout-vortex{background:rgba(249,115,22,.08);border-color:var(--vortex);color:#fdba74}
  .data-table{width:100%;border-collapse:collapse;margin:1.4rem 0;font-family:'DM Mono',monospace;font-size:.84rem}
  .data-table th{text-align:left;font-size:.65rem;font-weight:700;letter-spacing:.15em;text-transform:uppercase;color:var(--muted);padding:.75rem 1rem;border-bottom:1px solid var(--border)}
  .data-table td{padding:.9rem 1rem;border-bottom:1px solid #1a1f30;color:var(--text);vertical-align:top}
  .data-table tr:last-child td{border-bottom:none}
  .data-table tr:hover td{background:var(--surface2)}
  aside::-webkit-scrollbar{width:4px}
  aside::-webkit-scrollbar-thumb{background:var(--border);border-radius:2px}
  @media(max-width:768px){.layout{grid-template-columns:1fr};aside{position:relative;height:auto};main{padding:2rem 1.5rem};h1{font-size:1.9rem}}
</style>
</head>
<body>
<div class="layout">
<aside>
  <a class="back-bar" href="../index.html"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M19 12H5M12 19l-7-7 7-7"/></svg> All docs</a>
  <div class="sidebar-header">
    <div class="sidebar-pkg">echelon.module.vortex</div>
    <div class="sidebar-classname">@Vortexable</div>
    <span class="sidebar-kind">annotation</span>
  </div>
  <nav>
    <span class="nav-section">Overview</span>
    <a href="#overview">Overview</a>
    <a href="#attributes">Attributes</a>
    <a href="#opt-out-model">Opt-out model</a>

    <span class="nav-section">Policy enum</span>
    <a href="#policy">Policy</a>
    <a href="#absorbable">ABSORBABLE</a>
    <a href="#locked">LOCKED</a>
    <a href="#include">INCLUDE</a>

    <span class="nav-section">Usage</span>
    <a href="#sealing-classes">Sealing classes</a>
    <a href="#vs-modprotection">vs @ModProtection</a>

    <span class="nav-section">See also</span>
    <a href="VortexLoader.html">VortexLoader →</a>
    <a href="VortexManager.html">VortexManager →</a>
    <a href="ModProtection.html">@ModProtection →</a>
  </nav>
</aside>
<main>

  <div class="hero" id="overview">
    <div class="hero-badge">echelon.module.vortex</div>
    <h1>@Vortexable</h1>
    <div class="hero-meta">
      <span>Package <code>echelon.module.vortex</code></span>
      <span>Retention <code>RUNTIME</code></span>
      <span>Target <code>TYPE</code></span>
    </div>
    <p class="hero-desc">Controls whether <a href="VortexLoader.html" style="color:var(--vortex);text-decoration:none"><code>VortexLoader</code></a> is allowed to override a class with an external <code>.class</code> file. Applied on the <em>original</em> class inside the JAR to communicate intent to the loader — not applied to the override itself.</p>
  </div>

  <section id="attributes">
    <h2>Attributes</h2>
    <table class="data-table">
      <thead><tr><th>Attribute</th><th>Type</th><th>Default</th><th>Description</th></tr></thead>
      <tbody>
        <tr><td><code>value</code></td><td><code>Policy</code></td><td><code>ABSORBABLE</code></td><td>The absorption policy for this class.</td></tr>
        <tr><td><code>version</code></td><td><code>String</code></td><td><code>"1.0.0"</code></td><td>Version of this class. Vortex compares JAR version against the external override's version to determine if the override is actually newer. Format: <code>"major.minor.patch"</code>.</td></tr>
      </tbody>
    </table>
  </section>

  <section id="opt-out-model">
    <h2>Opt-Out Model</h2>
    <p>Classes without <code>@Vortexable</code> are treated as <strong>ABSORBABLE by default</strong>. You do not need to annotate every class — only annotate the ones you want to protect (<code>LOCKED</code>) or explicitly mark as intended new additions (<code>INCLUDE</code>).</p>
    <div class="callout callout-vortex">
      <strong>Default is permissive</strong>
      If you want a class to be overridable, don't annotate it at all. <code>@Vortexable</code> (with no arguments) is redundant but valid. Only use the annotation when you need <code>LOCKED</code> or <code>INCLUDE</code>.
    </div>
  </section>

  <!-- POLICY ENUM -->
  <div class="class-divider" id="policy">
    <span class="class-divider-badge badge-enum">nested enum</span>
    <h2>Policy</h2>
  </div>

  <section id="absorbable">
    <h2>ABSORBABLE</h2>
    <p>The default. <code>VortexLoader</code> will replace this class if a matching <code>.class</code> file is found in <code>system/</code>. No annotation needed — this is the implicit policy for every class not marked <code>LOCKED</code>.</p>
<pre data-lang="Java"><code><span class="cm">// These two are equivalent — no annotation needed</span>
<span class="kw">public class</span> <span class="ty">DesktopPanel</span> { ... }

<span class="an">@Vortexable</span> <span class="cm">// explicit but redundant</span>
<span class="kw">public class</span> <span class="ty">DesktopPanel</span> { ... }</code></pre>
  </section>

  <section id="locked">
    <h2>LOCKED</h2>
    <p>The class is sealed. <code>VortexLoader</code> will check the original class for this annotation before defining an override — if found, it rejects the override, adds the class to an in-memory locked set, fires <code>VortexEvent.REJECTED_LOCKED</code>, and falls back to the JAR version. All future loads of this class name also skip the override.</p>
    <div class="callout callout-danger">
      <strong>Always lock these</strong>
      At minimum: <code>VortexManager</code>, <code>VortexLoader</code>, and any authentication, cryptography, or security-critical classes. A malicious override of these could compromise the entire loading system.
    </div>
<pre data-lang="Java"><code><span class="an">@Vortexable</span>(<span class="ty">Vortexable</span>.Policy.LOCKED)
<span class="kw">public class</span> <span class="ty">VortexManager</span> { ... }

<span class="an">@Vortexable</span>(<span class="ty">Vortexable</span>.Policy.LOCKED)
<span class="kw">public class</span> <span class="ty">SecurityCore</span> { ... }

<span class="an">@Vortexable</span>(<span class="ty">Vortexable</span>.Policy.LOCKED)
<span class="kw">public class</span> <span class="ty">AuthManager</span> { ... }</code></pre>
  </section>

  <section id="include">
    <h2>INCLUDE</h2>
    <p>Marks a class as intentionally new — it should not already exist in the app JAR. This policy is enforced at the directory level: classes in the vortex root (outside <code>system/</code>) are automatically treated as includes by <code>VortexLoader</code> and rejected with <code>REJECTED_INCLUDE_CONFLICT</code> if they already exist in the parent. Annotating with <code>INCLUDE</code> explicitly documents intent but does not add behaviour beyond what the directory already enforces.</p>
<pre data-lang="Java"><code><span class="cm">// Placed in vortex-module/echelon/newfeature/CoolWidget.class</span>
<span class="an">@Vortexable</span>(<span class="ty">Vortexable</span>.Policy.INCLUDE)
<span class="kw">public class</span> <span class="ty">CoolWidget</span> {
    <span class="cm">// This class does not exist in the JAR — purely additive</span>
}</code></pre>
  </section>

  <section id="sealing-classes">
    <h2>Sealing Classes in Practice</h2>
    <p>The check runs before any bytes are read from the override file. <code>VortexLoader.isOriginalLocked()</code> loads the original via the parent classloader and reflectively inspects the annotation at runtime. This means there is no compile-time overhead — the annotation only costs a tiny reflection call during the first load attempt of each class name.</p>
<pre data-lang="Java"><code><span class="cm">// Recommended: annotate with version too, so Vortex can compare</span>
<span class="an">@Vortexable</span>(value = <span class="ty">Vortexable</span>.Policy.ABSORBABLE, version = <span class="str">"1.3.0"</span>)
<span class="kw">public class</span> <span class="ty">WindowManager</span> { ... }

<span class="cm">// Now if an override claims version "1.2.0", Vortex knows it's older</span></code></pre>
  </section>

  <section id="vs-modprotection">
    <h2>@Vortexable vs @ModProtection</h2>
    <p>These two annotations operate at completely different levels of the system and are intentionally independent:</p>
    <table class="data-table">
      <thead><tr><th></th><th>@Vortexable</th><th>@ModProtection</th></tr></thead>
      <tbody>
        <tr><td><strong>Layer</strong></td><td>Framework — developer-level</td><td>Module — user-level</td></tr>
        <tr><td><strong>Who applies overrides</strong></td><td>Developer dropping <code>.class</code> into <code>system/</code></td><td>End user placing files in <code>mod/</code></td></tr>
        <tr><td><strong>Enforced by</strong></td><td><code>VortexLoader</code></td><td><code>ModuleFirstClassLoader</code> inside <code>CentralModuleOpener</code></td></tr>
        <tr><td><strong>Scope</strong></td><td>Entire app — all classes at the JAR level</td><td>Individual module — only affects that module's class loading</td></tr>
        <tr><td><strong>Load order</strong></td><td colspan="2" style="text-align:center;color:#6b7280">Vortex overrides → ModProtection mods → JAR originals</td></tr>
      </tbody>
    </table>
    <div class="callout callout-info">
      <strong>Both can coexist on the same class</strong>
      A class can have both <code>@Vortexable(LOCKED)</code> (preventing framework-level overrides) and <code>@ModProtection(DISALLOW_MOD)</code> (preventing user-level module mods). Each system checks its own annotation independently.
    </div>
  </section>

</main>
</div>
</body>
</html>
