<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Triton Framework — Docs</title>
<link href="https://fonts.googleapis.com/css2?family=DM+Mono:ital,wght@0,300;0,400;0,500;1,400&family=Syne:wght@400;600;700;800&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #0b0d12; --surface: #111420; --surface2: #181c2b;
    --border: #232840; --accent: #4f8ef7; --accent2: #a78bfa;
    --warn: #f59e0b; --success: #22c55e; --text: #d4d8f0;
    --muted: #6b7280; --code-bg: #0d1117;
  }
  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
  html { scroll-behavior: smooth; }
  body { font-family: 'Syne', sans-serif; background: var(--bg); color: var(--text); line-height: 1.7; min-height: 100vh; }
  body::before { content: ''; position: fixed; inset: 0; background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.03'/%3E%3C/svg%3E"); pointer-events: none; z-index: 0; }

  /* Header */
  header { position: relative; z-index: 10; border-bottom: 1px solid var(--border); background: var(--surface); padding: 0 4rem; display: flex; align-items: center; justify-content: space-between; height: 68px; }
  .header-logo { display: flex; align-items: center; gap: 0.85rem; text-decoration: none; }
  .logo-mark { width: 34px; height: 34px; border-radius: 9px; background: linear-gradient(135deg, var(--accent), var(--accent2)); display: flex; align-items: center; justify-content: center; font-size: 0.85rem; font-weight: 800; color: #fff; flex-shrink: 0; }
  .logo-text { font-size: 1.05rem; font-weight: 700; color: #fff; }
  .header-meta { font-family: 'DM Mono', monospace; font-size: 0.82rem; color: var(--muted); display: flex; align-items: center; gap: 2rem; }
  .header-meta a { color: var(--muted); text-decoration: none; transition: color 0.15s; }
  .header-meta a:hover { color: var(--text); }
  .version-badge { display: inline-flex; align-items: center; gap: 0.45rem; background: rgba(79,142,247,0.1); border: 1px solid rgba(79,142,247,0.25); color: var(--accent); border-radius: 100px; padding: 0.28rem 0.85rem; font-size: 0.75rem; font-weight: 600; letter-spacing: 0.08em; }

  /* Hero */
  .hero { position: relative; z-index: 1; padding: 6rem 4rem 4rem; text-align: center; overflow: hidden; }
  .hero::before { content: ''; position: absolute; top: -60px; left: 50%; transform: translateX(-50%); width: 800px; height: 400px; background: radial-gradient(ellipse, rgba(79,142,247,0.13) 0%, transparent 70%); pointer-events: none; }
  .hero-eyebrow { font-family: 'DM Mono', monospace; font-size: 0.8rem; font-weight: 500; letter-spacing: 0.22em; text-transform: uppercase; color: var(--accent); margin-bottom: 1.25rem; }
  h1 { font-size: 4rem; font-weight: 800; color: #fff; line-height: 1.05; margin-bottom: 1.25rem; letter-spacing: -0.025em; }
  .hero-sub { font-family: 'DM Mono', monospace; font-size: 1.05rem; font-weight: 300; color: var(--muted); max-width: 540px; margin: 0 auto 3rem; line-height: 1.75; }

  /* Search */
  .search-wrap { position: relative; max-width: 560px; margin: 0 auto; }
  .search-icon { position: absolute; left: 1.25rem; top: 50%; transform: translateY(-50%); color: var(--muted); pointer-events: none; }
  #search { width: 100%; background: var(--surface); border: 1px solid var(--border); border-radius: 12px; padding: 1rem 1.25rem 1rem 3.2rem; font-family: 'DM Mono', monospace; font-size: 1rem; font-weight: 300; color: var(--text); outline: none; transition: border-color 0.15s, box-shadow 0.15s; }
  #search::placeholder { color: var(--muted); }
  #search:focus { border-color: rgba(79,142,247,0.5); box-shadow: 0 0 0 4px rgba(79,142,247,0.08); }
  .search-clear { position: absolute; right: 1.25rem; top: 50%; transform: translateY(-50%); background: none; border: none; color: var(--muted); cursor: pointer; font-size: 1.1rem; line-height: 1; padding: 0.2rem; display: none; transition: color 0.15s; }
  .search-clear:hover { color: var(--text); }
  .search-clear.visible { display: block; }

  /* Filters */
  .filters { position: relative; z-index: 1; padding: 0 4rem; display: flex; align-items: center; gap: 0.6rem; flex-wrap: wrap; margin-bottom: 2.5rem; }
  .filter-label { font-family: 'DM Mono', monospace; font-size: 0.75rem; color: var(--muted); margin-right: 0.25rem; letter-spacing: 0.08em; text-transform: uppercase; }
  .tag-btn { background: none; border: 1px solid var(--border); border-radius: 100px; padding: 0.3rem 0.9rem; font-family: 'DM Mono', monospace; font-size: 0.78rem; color: var(--muted); cursor: pointer; transition: all 0.15s; letter-spacing: 0.04em; }
  .tag-btn:hover, .tag-btn.active { border-color: var(--accent); color: var(--accent); background: rgba(79,142,247,0.08); }

  /* Grid */
  .grid-wrap { position: relative; z-index: 1; padding: 0 4rem 6rem; }
  .results-meta { font-family: 'DM Mono', monospace; font-size: 0.82rem; color: var(--muted); margin-bottom: 1.75rem; }
  .results-meta span { color: var(--text); font-weight: 500; }

  #grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(420px, 1fr)); gap: 1.5rem; align-items: start; }

  /* Card */
  .card { background: var(--surface); border: 1px solid var(--border); border-radius: 16px; padding: 2rem 2rem 1.75rem; text-decoration: none; display: flex; flex-direction: column; position: relative; overflow: hidden; cursor: pointer; transition: border-color 0.2s, box-shadow 0.2s, transform 0.2s; }
  .card::before { content: ''; position: absolute; inset: 0; background: linear-gradient(135deg, rgba(79,142,247,0.05) 0%, transparent 55%); opacity: 0; transition: opacity 0.25s; pointer-events: none; }
  .card:hover { border-color: rgba(79,142,247,0.45); transform: translateY(-3px); box-shadow: 0 12px 40px rgba(0,0,0,0.5), 0 0 0 1px rgba(79,142,247,0.1); }
  .card:hover::before { opacity: 1; }

  /* Card header */
  .card-header { display: flex; align-items: flex-start; gap: 1rem; margin-bottom: 1rem; }
  .card-icon { width: 46px; height: 46px; border-radius: 12px; background: rgba(79,142,247,0.12); border: 1px solid rgba(79,142,247,0.2); display: flex; align-items: center; justify-content: center; flex-shrink: 0; color: var(--accent); transition: background 0.2s, border-color 0.2s; }
  .card:hover .card-icon { background: rgba(79,142,247,0.2); border-color: rgba(79,142,247,0.4); }
  .card-title-group { flex: 1; min-width: 0; }
  .card-title { font-size: 1.15rem; font-weight: 700; color: #fff; line-height: 1.3; margin-bottom: 0.2rem; }
  .card-pkg { font-family: 'DM Mono', monospace; font-size: 0.72rem; color: var(--muted); letter-spacing: 0.03em; }
  .card-arrow { color: var(--muted); transition: color 0.15s, transform 0.2s; flex-shrink: 0; margin-top: 4px; }
  .card:hover .card-arrow { color: var(--accent); transform: translate(3px, -3px); }

  /* Description — clamp 2 lines, expand on hover */
  .card-desc {
    font-family: 'DM Mono', monospace; font-size: 0.875rem; font-weight: 300;
    color: var(--muted); line-height: 1.8; margin-bottom: 1.1rem;
    display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical;
    overflow: hidden; max-height: calc(1.8em * 2 + 0.1px);
    transition: max-height 0.35s ease, color 0.2s, -webkit-line-clamp 0.2s;
  }
  .card:hover .card-desc { -webkit-line-clamp: unset; max-height: 14rem; color: #9aa0be; }

  /* Inner class pills */
  .card-inners { display: flex; gap: 0.4rem; flex-wrap: wrap; margin-bottom: 1rem; }
  .inner-pill { display: inline-flex; align-items: center; gap: 0.35rem; background: rgba(167,139,250,0.08); border: 1px solid rgba(167,139,250,0.2); border-radius: 6px; padding: 0.2em 0.65em; font-family: 'DM Mono', monospace; font-size: 0.72rem; color: var(--accent2); }
  .inner-pill::before { content: '↳'; font-size: 0.65rem; opacity: 0.6; }

  /* Card footer */
  .card-footer { display: flex; align-items: center; justify-content: space-between; gap: 0.5rem; flex-wrap: wrap; border-top: 1px solid var(--border); padding-top: 1rem; margin-top: auto; }
  .card-tags { display: flex; gap: 0.4rem; flex-wrap: wrap; }
  .card-tag { background: rgba(255,255,255,0.05); border: 1px solid var(--border); border-radius: 5px; padding: 0.15em 0.6em; font-family: 'DM Mono', monospace; font-size: 0.72rem; color: var(--muted); }
  .card-date { font-family: 'DM Mono', monospace; font-size: 0.72rem; color: #3a4060; }

  /* States */
  #empty { display: none; text-align: center; padding: 6rem 2rem; font-family: 'DM Mono', monospace; color: var(--muted); }
  #empty .empty-icon { font-size: 3rem; margin-bottom: 1rem; }
  #empty p { font-size: 0.95rem; line-height: 1.7; }
  #loading { text-align: center; padding: 6rem 2rem; font-family: 'DM Mono', monospace; font-size: 0.9rem; color: var(--muted); }
  .spinner { display: inline-block; width: 22px; height: 22px; border: 2px solid var(--border); border-top-color: var(--accent); border-radius: 50%; animation: spin 0.7s linear infinite; margin-bottom: 1rem; }
  @keyframes spin { to { transform: rotate(360deg); } }

  footer { position: relative; z-index: 1; border-top: 1px solid var(--border); padding: 1.75rem 4rem; display: flex; align-items: center; justify-content: space-between; font-family: 'DM Mono', monospace; font-size: 0.78rem; color: var(--muted); }
  footer a { color: var(--muted); text-decoration: none; }
  footer a:hover { color: var(--text); }
  mark { background: rgba(79,142,247,0.25); color: var(--accent); border-radius: 2px; padding: 0 1px; }

  @media (max-width: 700px) {
    header, .filters, .grid-wrap, footer { padding-left: 1.5rem; padding-right: 1.5rem; }
    .hero { padding: 3.5rem 1.5rem 2.5rem; }
    h1 { font-size: 2.5rem; }
    #grid { grid-template-columns: 1fr; }
    footer { flex-direction: column; gap: 0.5rem; text-align: center; }
  }
</style>
</head>
<body>

<header>
  <a class="header-logo" href="index.html">
    <div class="logo-mark">T</div>
    <span class="logo-text">Triton Framework</span>
  </a>
  <div class="header-meta">
    <span class="version-badge" id="site-version">loading…</span>
    <a href="#" id="repo-link">GitHub ↗</a>
  </div>
</header>

<section class="hero">
  <div class="hero-eyebrow">Developer Reference</div>
  <h1>Documentation</h1>
  <p class="hero-sub" id="site-desc">Loading…</p>
  <div class="search-wrap">
    <svg class="search-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg>
    <input id="search" type="text" placeholder="Search classes, tags, descriptions…" autocomplete="off" spellcheck="false">
    <button class="search-clear" id="search-clear" aria-label="Clear">✕</button>
  </div>
</section>

<div class="filters" id="filters">
  <span class="filter-label">Filter:</span>
  <button class="tag-btn active" data-tag="all">All</button>
</div>

<div class="grid-wrap">
  <div class="results-meta" id="results-meta"></div>
  <div id="loading"><div class="spinner"></div><br>Loading docs…</div>
  <div id="grid"></div>
  <div id="empty"><div class="empty-icon">⌕</div><p>No pages match your search.<br>Try a different term or clear the filter.</p></div>
</div>

<footer>
  <span id="footer-name">Triton Framework</span>
  <span>Built from <a href="site.json">site.json</a> · Pages in <code>/doc</code></span>
</footer>

<script>
  const TAG_ICONS = {
    core:       `<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>`,
    modules:    `<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/></svg>`,
    classloader:`<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8"><ellipse cx="12" cy="5" rx="9" ry="3"/><path d="M3 5v14c0 1.66 4.03 3 9 3s9-1.34 9-3V5"/><path d="M3 12c0 1.66 4.03 3 9 3s9-1.34 9-3"/></svg>`,
    annotations:`<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8"><circle cx="12" cy="12" r="3"/><path d="M12 2v3M12 19v3M4.22 4.22l2.12 2.12M17.66 17.66l2.12 2.12M2 12h3M19 12h3M4.22 19.78l2.12-2.12M17.66 6.34l2.12-2.12"/></svg>`,
    ui:         `<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8"><rect x="3" y="3" width="18" height="18" rx="2"/><path d="M3 9h18M9 21V9"/></svg>`,
    chrome:     `<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>`,
    animation:  `<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8"><path d="M5 3l14 9-14 9V3z"/></svg>`,
  };
  const DEFAULT_ICON = `<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/></svg>`;

  const iconFor = tags => { for (const t of (tags||[])) if (TAG_ICONS[t]) return TAG_ICONS[t]; return DEFAULT_ICON; };
  const esc = s => String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');
  const hi = (t,q) => q ? esc(t).replace(new RegExp(`(${q.replace(/[.*+?^${}()|[\]\\]/g,'\\$&')})`, 'gi'), '<mark>$1</mark>') : esc(t);

  let allDocs=[], activeTag='all', searchQuery='';

  async function loadSite() {
    let data;
    try { const r = await fetch('site.json'); if (!r.ok) throw new Error('HTTP '+r.status); data = await r.json(); }
    catch(e) { document.getElementById('loading').innerHTML=`<p style="color:#ef4444;font-family:'DM Mono',monospace">⚠ Could not load site.json: ${e.message}</p>`; return; }

    const {site,docs} = data;
    document.title = `${site.name} — Docs`;
    document.getElementById('site-version').textContent = site.version||'latest';
    document.getElementById('site-desc').textContent = site.description||'';
    document.getElementById('footer-name').textContent = site.name;
    const rl = document.getElementById('repo-link');
    site.repo ? (rl.href=site.repo) : (rl.style.display='none');

    allDocs = docs||[];
    buildFilters();
    render();
    document.getElementById('loading').style.display='none';
  }

  function buildFilters() {
    const tags = new Set();
    allDocs.forEach(d=>(d.tags||[]).forEach(t=>tags.add(t)));
    const c = document.getElementById('filters');
    tags.forEach(tag => {
      const b = document.createElement('button');
      b.className='tag-btn'; b.dataset.tag=tag; b.textContent=tag;
      b.addEventListener('click', ()=>setTag(tag));
      c.appendChild(b);
    });
  }

  function setTag(tag) {
    activeTag=tag;
    document.querySelectorAll('.tag-btn').forEach(b=>b.classList.toggle('active', b.dataset.tag===tag));
    render();
  }

  function render() {
    const q = searchQuery.toLowerCase().trim();
    const grid=document.getElementById('grid'), empty=document.getElementById('empty'), meta=document.getElementById('results-meta');

    const filtered = allDocs.filter(d => {
      if (activeTag!=='all' && !(d.tags||[]).includes(activeTag)) return false;
      if (!q) return true;
      return d.title.toLowerCase().includes(q)
          || (d.description||'').toLowerCase().includes(q)
          || (d.package||'').toLowerCase().includes(q)
          || (d.tags||[]).some(t=>t.toLowerCase().includes(q))
          || (d.innerClasses||[]).some(ic=>ic.toLowerCase().includes(q));
    });

    grid.innerHTML='';
    if (!filtered.length) { empty.style.display='block'; meta.innerHTML=''; return; }
    empty.style.display='none';
    meta.innerHTML = (q||activeTag!=='all')
      ? `Showing <span>${filtered.length}</span> of <span>${allDocs.length}</span> pages`
      : `<span>${allDocs.length}</span> page${allDocs.length!==1?'s':''}`;

    filtered.forEach(doc => {
      const card = document.createElement('a');
      card.className='card'; card.href=doc.file||'#';
      const tags = (doc.tags||[]).map(t=>`<span class="card-tag">${esc(t)}</span>`).join('');
      const inners = (doc.innerClasses||[]).map(ic=>`<span class="inner-pill">${esc(ic)}</span>`).join('');
      card.innerHTML = `
        <div class="card-header">
          <div class="card-icon">${iconFor(doc.tags)}</div>
          <div class="card-title-group">
            <div class="card-title">${hi(doc.title,q)}</div>
            ${doc.package?`<div class="card-pkg">${hi(doc.package,q)}</div>`:''}
          </div>
          <span class="card-arrow"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M7 17L17 7M7 7h10v10"/></svg></span>
        </div>
        <p class="card-desc">${hi(doc.description||'',q)}</p>
        ${inners?`<div class="card-inners">${inners}</div>`:''}
        <div class="card-footer">
          <div class="card-tags">${tags}</div>
          <span class="card-date">${doc.updated||''}</span>
        </div>`;
      grid.appendChild(card);
    });
  }

  const si=document.getElementById('search'), cb=document.getElementById('search-clear');
  si.addEventListener('input', ()=>{ searchQuery=si.value; cb.classList.toggle('visible',si.value.length>0); render(); });
  cb.addEventListener('click', ()=>{ si.value=''; searchQuery=''; cb.classList.remove('visible'); si.focus(); render(); });

  loadSite();
</script>
</body>
</html>
